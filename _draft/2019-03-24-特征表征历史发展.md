---
layout:     post
title:      "深度学习与计算机视觉-特征表征历史发展"
subtitle:   "2.特征表征历史发展"
date:       2019-03-24 12:40:00
author:     "魔峥"
header-img: "img/post-bg-2015.jpg"
catalog: true
mathjax: true

tags:
    - 深度学习与计算机视觉
    - 体系整理
---



# 特征表征历史发展

在介绍图像之前，我一定会说一下传统机器学习该怎样做。因为传统机器学习是基础，不仅是技术传续，还有思想的传承。

## 1 计算机表征数据方法
上一篇说过我们的目标是“**让计算机具有学习能力，计算机能够自己适应事先不可知事物的新输入**”。前人通过模拟人类的思考方式，想到了一种方法：可以将“不可知事物的输入”改换成“不可知事物数字特征的输入”，化不可运算数据为可运算数据。

### 1.1 数据化--主要思想：抽象表示

#### 数据类型化

计算机的输入是高电频，低电频信号，转换为数字即为“0-1字符”，但数据与数据大不相同。例如7摄氏度与8摄氏度可以数据化为7，8；第一街与第二街分别数据化为1，2；纸币面额10元，20元可以数字化为10，20。虽然都是已经变为数字，数字是可以相加，但是含义却有本质的不同。“7摄氏度+8摄氏度”还勉强能说出含义，但“第一街+第二街”是什么意思如果抛去实际含义，仅仅计算1+2=3，那么就变成“第一街+第二街=第三街”的笑话了。
我们这里可以给数据添加类型，如下表使用类型的方式限制输出。

| 类型 | 含义                                 |
| ---- | ------------------------------------ |
| 数值 | 具有实际测量意义，可以计算           |
| 类别 | 数值不能计算，没有数值意义，仅定性   |
| 时间 | 年月日：时分秒，特别常用这里单列     |
| 空间 | 地理位置信息，可以计算但不能简单计算 |
| 文本 | 文本信息（NLP相关）                  |
| 图片 | RGB三色信息                          |

说到这里，我们列举了很多实际事物数据化的方法。仔细观察好像与SQL数据库通用格式很像。的确，数据库软件的存在的最初目的就是对事物进行数据化存储。但在大数据数据时代，传统的关系型数据库已经不足以支持这么大规模的数据任务。关系型数据库转变成为了文件型数据库，文件型数据库对图片等非结构化数据库的存储有很大帮助。由于数据存储是个大工程，与本文无关，这里不多做阐述。

#### 数据多维化

指定类型就行了吗？不。我们还要靠数字的编组来表示复杂事务。例如每个“0-1字符”一位，即为1bit。8bit编一组叫做1Byte表示0-255。在256色图像中，1Byte数据为一通道，3个Byte数据（分别代表RGB（红绿蓝））组成颜色图片1像素。点阵的多个像素（H*W个像素）组成一张图片。在做数据训练的时候，不是一张图片一张图片进行训练调参，而是一批（batch）图片一批（batch）图片进行训练调参。我们可以看到编组可以深层次地抽象的事务。

### 1.2 数据清洗--主要思想：数据清晰
选用合适的方法进行数据化，只是机器学习开始的一小步。在实际生产中，我们接收到数据可能会很非常差：格式的错误，长尾的冗余，重要项的缺失，等等。**所以接到数据的第一步，是将原始数据可视化，大致浏览下数据的内容**。 通过浏览可视化数据，我们可以处理一些可识别的错误：包括检查数据一致性，处理无效值和缺失值等。

在面对错误，冗余，缺失等可判断因素的“脏”数据时，“数据清洗”可起到一定的效果。数据清洗是对数据质量保证的最后一关，最终目的是使数据集中的数据达成一致性。数据的质量很大部分决定了模型的上限。

1. **错误数据**很容易理解，但是数据错误是很难识别的一件事。例如一个数据：毛某某，小学生，年龄31岁。这类数据明显有问题，但是我们不好做出确切评论。

2. **冗余**表面上很好理解，例如我们在分析微博评论数据时，经常会遇到水军刷屏，这样的信息肯定是需要去除的。但是怎么判断那条是水军的回复呢？或者放大点说，怎么判断是长尾冗余言论呢？

3. **重要项缺失**表面上也好理解，就是重要特征缺失。例如做用户画像时，性别数据缺失。如果遇到次要数据（例如在做预测天气时，每条数据中的“气象台联系电话”这一选项缺失）我们可以直接在数据清洗这一过程就适当做一下数据挑选，直接把这一项去掉。重要不重要，待遇相差就这么大。。

   这里存在一个逻辑：在完全未知的情况下，你怎么知道缺失的项属于重要项？

   例如，当我们做人脸识别时，我们会需要一些原始图片数据。
   我们常常会收到奇怪的图片，例如这样：

   ![在这里插入图片描述](/img/mozheng/1-1.jpg)
   ![在这里插入图片描述](/img/mozheng/1-2.jpg)
   ![在这里插入图片描述](/img/mozheng/1-3.png)
   
   [emoji 无语]。。。。

   对于有人脸识别经验的人这样的数据质量真的不算太好。因为脸部肌肉挤压，很多脸部特征被掩盖。我们想要的图片是特征明显数据，例如是这样：

   ![在这里插入图片描述](/img/author-mozheng.jpg) 
   ![在这里插入图片描述](/img/mozheng/1-5.jpg)
   ![在这里插入图片描述](/img/mozheng/1-6.jpeg)
   我们选后者，因为后面的数据轮廓更清晰，更有特征点。**这些东西外行是看不出来的，这也是比较要命的。**

4. **筛选掉数据真的没用吗？** 这又陷入了一个哲学问题。。因为有用和没用都是相对的。。例如上面的图片我们做人脸识别训练初期，可能用不上。但是在训练后期，需要提高模型的容错性时，我们有时还真需要这些奇葩图片。

这就是数据初选的意义。这么说来，人工干预的因素占很大比例。没错，做好数据筛选数据清洗，真的需要一定模型训练的经验。在业界广泛流传：数据和特征决定了机器学习的上限，而模型和算法只是逼近这个上限而已。个人认为这句话虽然些许夸大，但却说出了数据清洗的重要性。同时，这句话也引出了另一个重要概念：**特征选择与提取**”

## 2 数据特征提取
### 2.1 特征选择提取--主要思想：数据降维
特征工程指的是把原始数据转变为模型的训练数据的过程，它的目的就是为了获取更好的训练数据特征。什么叫更好的特征？这个很有说法。在特征工程发展初期，特征选择与提取阶段往往依靠经验丰富的专家。这也衍生出一种程序系统叫“专家系统”。特征选择是从特征中选出一个子集，而特征提取是从原始数据中构造出新的特征。特征提取体现了典型的“数据降维”思想，但是绝不是唯一具有“数据降维”思想的机器学习过程。

#### 2.1.1 传统机器学习特征选取
特征选取与降维是强关联。特征提取分为两种：线性特征提取，非线性特征提取。线性特征提取有PCA-主成分分析，LDA-线性判别分析，等等。非线性特征提取更多：如各种聚类，分类方法。
1. 主成分分析
主成分分析的原理是将一个高维向量，通过一个特殊的特征向量矩阵，投影到一个低维的向量空间中，并且仅仅损失了一些次要信息。也就是说，通过低维特征可以基本重构出所对应的原始高维向量。这个算法在现代推荐系统中也十分常见。SVD算法就是一种主成分分析方法。
2. LDA-线性判别分析
LDA是一种监督学习的降维技术，也就是说它的数据集的每个样本是有类别输出的。这点和PCA不同。PCA是不考虑样本类别输出的无监督降维技术。LDA是通过将数据在低纬度上进行投影，投影后希望每一种类别数据的投影点尽可能的接近，而不同类别的数据的类别中心之间的距离尽可能的大。
3. 聚类
将物理或抽象对象的集合分成由类似的对象组成的多个类的过程被称为聚类。由聚类所生成的簇是一组数据对象的集合，这些对象与同一个簇中的对象彼此相似，与其他簇中的对象相异。每一簇就是一类特征。 对于聚类在实际的应用中亦是非常广泛的，如：市场细分、社交圈分、集群计算、天体数据分析。更多内容可以点击看这里：https://blog.csdn.net/dajiabudongdao/article/details/52053222
#### 2.1.2 基于梯度的图片的特征选取
传统图片认为识别物体最关键的因素是梯度（这就衍生出SIFT/HOG这两种算法），梯度意味着边缘，这是最本质的部分，而计算梯度，自然就用到灰度图像了，可以把灰度理解为图像的强度。而且颜色，易受光照影响，难以提供关键信息，故将图像进行灰度化，同时也可以加快特征提取的速度。这也是一种降维，将彩色图片变成线条图片。如下图：
![梯度图片](/img/mozheng/梯度图片.png)
为了得到这样的图片，我们可以使用梯度算子模板对图片进行卷积操作。梯度算子模板有Sobel 算子，Scharr 算子和Laplacian 算子等
1. Sobel 算子和 Scharr 算子
Sobel 算子是高斯平滑与微分操作的结合体，所以它的抗噪声能力很好，可以设定求导的方向（xorder 或 yorder），还可以设定使用的卷积核的大小（ksize），如果 ksize=-1，会使用 3x3 的 Scharr 滤波器，它的的效果要比 3x3 的 Sobel 滤波器好（而且速度相同，所以在使用 3x3 滤波器时应该尽量使用 Scharr 滤波器）。
2. Laplacian 算子
拉普拉斯算子可以使用二阶导数的形式定义，可假设其离散实现类似于二阶 Sobel 导数，事实上， OpenCV 在计算拉普拉斯算子时直接调用 Sobel 算子。

![算子](/img/mozheng/算子.png)

上方依次为3x3的 Scharr 滤波器卷积核x方向，y方向，拉普拉斯算子时直接调用 Sobel 算子卷积核。我们常用的特征提取方法还HOG，SIFT两种
3. HOG（histogram of oriented gradients）
HOG通过统计计算图像局部区域的梯度方向直方图来构成特征。梯度的方向是标量场增长最快的方向，梯度的大小是这个最大的变化率。对图像来说，图像的梯度即像素值变化最快的方向，并且图像的边缘与梯度保持垂直。图像局部区域的特征能够被梯度或边缘的方向密度分布很好的描述。
4. SIFT（scale invariant feature transform）
SIFT 特征通常与使用SIFT检测器得到的感兴趣点一起使用。这些感兴趣点与一个特定的方向和尺度（scale）相关联。通常是在对一个图像中的方形区域通过相应的方向和尺度变换后，再计算该区域的SIFT特征。SIFT算法的实质是在不同的尺度空间上查找关键点(特征点)，并计算出关键点的方向。SIFT所查找到的关键点是一些十分突出，不会因光照，仿射变换和噪音等因素而变化的点，如角点、边缘点、暗区的亮点及亮区的暗点等。

#### 2.1.3 卷积神经网络进行图片特征选取

从上一节可以看出，我们需要精心设计模板参数，才能达到我们的需求。有没有可能让机器自己学习模板参数？深度学习CNN就是这个思想。